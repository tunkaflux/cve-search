<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen" />
    <link rel="stylesheet" type="text/css" href="stylesheets/pygment_trac.css" media="screen" />
    <link rel="stylesheet" type="text/css" href="stylesheets/print.css" media="print" />
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <title>Cve-search - Common Vulnerabilities and Exposures local search tool by adulau</title>
  </head>

  <body>
    <div id="container">
      <div class="inner">

        <header>
          <h1>Cve-search - Common Vulnerabilities and Exposures local search tool</h1>
          <h2>cve-search is a tool to import CVE (Common Vulnerabilities and Exposures) and CPE (Common Platform Enumeration) into a MongoDB to facilitate search and processing of CVEs.</h2>
        </header>

        <section id="downloads" class="clearfix">
          <a href="https://github.com/adulau/cve-search/zipball/master" id="download-zip" class="button"><span>Download .zip</span></a>
          <a href="https://github.com/adulau/cve-search/tarball/master" id="download-tar-gz" class="button"><span>Download .tar.gz</span></a>
          <a href="https://github.com/adulau/cve-search" id="view-on-github" class="button"><span>View on GitHub</span></a>
        </section>

        <hr>

        <section id="main_content">
          <h1>
<a name="cve-search" class="anchor" href="#cve-search"><span class="octicon octicon-link"></span></a>cve-search</h1>

<p>cve-search is a tool to import CVE (Common Vulnerabilities and Exposures) and
CPE (Common Platform Enumeration) into a MongoDB to facilitate search
and processing of CVEs.</p>

<p>The main objective of the software is to avoid doing direct and public lookup
into the public CVE databases. This is usually faster to do local lookups and
limits your sensitive queries via the Internet.</p>

<p><img src="https://farm9.staticflickr.com/8109/8603509755_c7690c2de4_n.jpg" alt="cve-search visualization" title="CVE Keywords Visualization Using Data From cve-search"><a href="http://www.foo.be/cve/">http://www.foo.be/cve/</a></p>

<h2>
<a name="requirements" class="anchor" href="#requirements"><span class="octicon octicon-link"></span></a>Requirements</h2>

<ul>
<li>Python 3</li>
<li>MongoDB</li>
<li>PyMongo</li>
<li>sax parser (part of Python)</li>
<li>feedformater (for RSS and Atom dump_last) <a href="http://code.google.com/p/feedformatter/">http://code.google.com/p/feedformatter/</a>
</li>
</ul><p>If you are planning to use the full-text indexer, you'll need:</p>

<ul>
<li>Whoosh <a href="http://packages.python.org/Whoosh/">http://packages.python.org/Whoosh/</a>
</li>
</ul><h2>
<a name="installation-of-mongodb" class="anchor" href="#installation-of-mongodb"><span class="octicon octicon-link"></span></a>Installation of MongoDB</h2>

<p>First, you'll need to have a Python 3 installation (3.2 or 3.3 preferred).
Then you need to install MongoDB (2.2) from source (this should also work
with any standard packages from your favorite distribution). Don't forget
to install the headers for development while installing MongoDB.</p>

<p>Then, you'll need to install PyMongo to access from Python 3 the MongoDB
databases. For installing PyMongo, you can download the source from the
original website <a href="https://github.com/mongodb/mongo-python-driver">https://github.com/mongodb/mongo-python-driver</a> .</p>

<pre><code>git clone https://github.com/mongodb/mongo-python-driver.git
cd mongo-python-driver
python3 setup.py build
sudo python3 setup.py install
</code></pre>

<h2>
<a name="populating-the-database" class="anchor" href="#populating-the-database"><span class="octicon octicon-link"></span></a>Populating the database</h2>

<p>For the initial run, you need to populate the CVE database by running:</p>

<pre><code>./db_mgmt.py -p
./db_mgmt_cpe_dictionnary.py
</code></pre>

<p>It will fetch all the existing XML files from the Common Vulnerabilities
and Exposures database and the Common Platform Enumeration.</p>

<p>By default, there is no secondary indexes created in MongoDB for the
CVE/CPE database. You might want to create indexes on the fields that are
commonly used for your searches. As the example, you can create the index
for the following collection and key:</p>

<pre><code>db.cpe.ensureIndex( {id:1 } )
db.cves.ensureIndex( {id:1} )
db.cves.ensureIndex( {vulnerable_configuration:1} )
db.vfeed.ensureIndex( {id:1} )
db.vendor.ensureIndex( {id:1} )
</code></pre>

<h2>
<a name="database-and-collections" class="anchor" href="#database-and-collections"><span class="octicon octicon-link"></span></a>Database and collections</h2>

<p>The MongoDB database is called cvedb and there are 6 collections:</p>

<ul>
<li>cves (Common Vulnerabilities and Exposure items) - source NVD NIST</li>
<li>cpe (Common Platform Enumeration items) - source NVD NIST</li>
<li>vendor (Official Vendor Statements on CVE Vulnerabilities) - source NVD NIST</li>
<li>cwe (Common Weakness Enumeration items) - source NVD NIST</li>
<li>ranking (ranking rules per group) - local cve-search</li>
<li>vfeed (cross-references to CVE ids (e.g. OVAL, OpenVAS, ...)) - source vfeed</li>
<li>info (metadata of each collection like last-modified) - local cve-search</li>
</ul><h2>
<a name="updating-the-database" class="anchor" href="#updating-the-database"><span class="octicon octicon-link"></span></a>Updating the database</h2>

<p>An updater script helps to start the db_mgmt_*  </p>

<pre><code>./db_updater.py -v
</code></pre>

<p>You can run it in a crontab, logging is done in syslog by default.</p>

<h2>
<a name="usage" class="anchor" href="#usage"><span class="octicon octicon-link"></span></a>Usage</h2>

<p>You can search the database using search.py</p>

<pre><code>./search.py -p cisco:ios:12.4
./search.py -p cisco:ios:12.4 -o json
./search.py -f nagios -n
./search.py -p microsoft:windows_7 -o html
</code></pre>

<p>If you want to search all the WebEx vulnerabilities and only printing the official
references from the supplier.</p>

<pre><code>./search.py -p webex: -o csv  -v "cisco"
</code></pre>

<p>You can also dump the JSON for a specific CVE ID.</p>

<pre><code>./search.py -c CVE-2010-3333
</code></pre>

<p>Or you can use the XMPP bot</p>

<pre><code>./search_xmpp.py -j mybot@jabber.org -p strongpassword
</code></pre>

<p>Or dump the last 2 CVE entries in RSS or Atom format</p>

<pre><code>./dump_last.py -f atom -l 2
</code></pre>

<h2>
<a name="usage-of-the-ranking-database" class="anchor" href="#usage-of-the-ranking-database"><span class="octicon octicon-link"></span></a>Usage of the ranking database</h2>

<p>There is a ranking database allowing to rank software vulnerabilities based on
their common platform enumeration name. The ranking can be done per organization
or department within your organization or any meaningful name for you.</p>

<p>As an example, you can add a partial CPE name like "sap:netweaver" which is very
critical for your accounting department.</p>

<pre><code>./python3.3 db_ranking.py  -c "sap:netweaver" -g "accounting" -r 3
</code></pre>

<p>and then you can lookup the ranking (-r option) for a specific CVE-ID:</p>

<pre><code>./python3.3 search.py -c CVE-2012-4341  -r  -n
</code></pre>

<h2>
<a name="fulltext-indexing" class="anchor" href="#fulltext-indexing"><span class="octicon octicon-link"></span></a>Fulltext indexing</h2>

<p>If you want to index all the CVEs from your current MongoDB collection:</p>

<pre><code>./python3.3 db_fulltext.py
</code></pre>

<p>and you query the fulltext index (to get a list of matching CVE-ID):</p>

<pre><code>./python3.3 search_fulltext.py -q NFS -q Linux
</code></pre>

<p>or to query the fulltext index and output the JSON object for each CVE-ID:</p>

<pre><code>./python3.3 search_fulltext.py -q NFS -q Linux -j
</code></pre>

<h2>
<a name="fulltext-visualization" class="anchor" href="#fulltext-visualization"><span class="octicon octicon-link"></span></a>Fulltext visualization</h2>

<p>The fulltext indexer visualization is using the fulltext indexes to build
a list of the most common keywords used in CVE. <a href="http://nltk.org/">NLTK</a> is
required to generate the keywords with the most common English
stopwords and lemmatize the output. <a href="http://nltk.org/nltk3-alpha/">NTLK for Python 3</a>
exists but you need to use the alpha version of NLTK.</p>

<pre><code>./python3.3 search_fulltext.py  -g -s &gt;cve.json
</code></pre>

<p>You can see a visualization on the <a href="http://www.foo.be/cve/">demo site</a>.</p>

<h2>
<a name="web-interface" class="anchor" href="#web-interface"><span class="octicon octicon-link"></span></a>Web interface</h2>

<p>The web interface is a minimal interface to see the last CVE entries and
query a specific CVE. You'll need flask in order to run the website and <a href="http://flask-pymongo.readthedocs.org/en/latest/">Flask-PyMongo</a>. To start
the web interface:</p>

<pre><code>cd ./web
./python3.3 index.py
</code></pre>

<p>Then you can connect on <a href="http://127.0.0.1:5000/">http://127.0.0.1:5000/</a> to browser the last CVE.</p>

<h2>
<a name="license" class="anchor" href="#license"><span class="octicon octicon-link"></span></a>License</h2>

<p>cve-search is free software released under the "Modified BSD license"</p>

<pre><code>Copyright (c) 2012 Wim Remes - https://github.com/wimremes/
Copyright (c) 2012-2013 Alexandre Dulaunoy - https://github.com/adulau/
</code></pre>
        </section>

        <footer>
          Cve-search - Common Vulnerabilities and Exposures local search tool is maintained by <a href="https://github.com/adulau">adulau</a><br>
          This page was generated by <a href="http://pages.github.com">GitHub Pages</a>. Tactile theme by <a href="https://twitter.com/jasonlong">Jason Long</a>.
        </footer>

        
      </div>
    </div>
  </body>
</html>